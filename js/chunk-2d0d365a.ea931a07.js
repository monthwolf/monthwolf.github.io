(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2d0d365a"],{"5d1f":function(t,e,n){
/**
 * @dice-roller/rpg-dice-roller - An advanced JS based dice roller that can roll various types of dice and modifiers, along with mathematical equations.
 * 
 * @version 5.1.0
 * @license MIT
 * @author GreenImp Media <info@greenimp.co.uk> (http://greenimp.co.uk)
 * @link https://dice-roller.github.io/documentation
 */
(function(t,r){r(e,n("bd2d"),n("3838"))})(0,(function(t,e,n){"use strict";function r(t){return r="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"===typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},r(t)}function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function u(t,e,n){return e&&o(t.prototype,e),n&&o(t,n),t}function a(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function s(t,e){if("function"!==typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&l(t,e)}function c(t){return c=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},c(t)}function l(t,e){return l=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},l(t,e)}function f(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}function h(t,e,n){return h=f()?Reflect.construct:function(t,e,n){var r=[null];r.push.apply(r,e);var i=Function.bind.apply(t,r),o=new i;return n&&l(o,n.prototype),o},h.apply(null,arguments)}function p(t){return-1!==Function.toString.call(t).indexOf("[native code]")}function y(t){var e="function"===typeof Map?new Map:void 0;return y=function(t){if(null===t||!p(t))return t;if("function"!==typeof t)throw new TypeError("Super expression must either be null or a function");if("undefined"!==typeof e){if(e.has(t))return e.get(t);e.set(t,n)}function n(){return h(t,arguments,c(this).constructor)}return n.prototype=Object.create(t.prototype,{constructor:{value:n,enumerable:!1,writable:!0,configurable:!0}}),l(n,t)},y(t)}function m(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function v(t,e){if(e&&("object"===typeof e||"function"===typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return m(t)}function d(t){var e=f();return function(){var n,r=c(t);if(e){var i=c(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return v(this,n)}}function g(t,e){while(!Object.prototype.hasOwnProperty.call(t,e))if(t=c(t),null===t)break;return t}function b(){return b="undefined"!==typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var r=g(t,e);if(r){var i=Object.getOwnPropertyDescriptor(r,e);return i.get?i.get.call(arguments.length<3?t:n):i.value}},b.apply(this,arguments)}function w(t,e,n,r){return w="undefined"!==typeof Reflect&&Reflect.set?Reflect.set:function(t,e,n,r){var i,o=g(t,e);if(o){if(i=Object.getOwnPropertyDescriptor(o,e),i.set)return i.set.call(r,n),!0;if(!i.writable)return!1}if(i=Object.getOwnPropertyDescriptor(r,e),i){if(!i.writable)return!1;i.value=n,Object.defineProperty(r,e,i)}else a(r,e,n);return!0},w(t,e,n,r)}function k(t,e,n,r,i){var o=w(t,e,n,r||t);if(!o&&i)throw new Error("failed to set property");return n}function S(t,e){return x(t)||T(t,e)||C(t,e)||j()}function A(t){return E(t)||O(t)||C(t)||R()}function E(t){if(Array.isArray(t))return N(t)}function x(t){if(Array.isArray(t))return t}function O(t){if("undefined"!==typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}function T(t,e){var n=null==t?null:"undefined"!==typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var r,i,o=[],u=!0,a=!1;try{for(n=n.call(t);!(u=(r=n.next()).done);u=!0)if(o.push(r.value),e&&o.length===e)break}catch(s){a=!0,i=s}finally{try{u||null==n["return"]||n["return"]()}finally{if(a)throw i}}return o}}function C(t,e){if(t){if("string"===typeof t)return N(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?N(t,e):void 0}}function N(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function R(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function j(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var P=function(t){s(n,t);var e=d(n);function n(t){var r;return i(this,n),r=e.call(this,'Operator "'.concat(t,'" is invalid')),TypeError.captureStackTrace&&TypeError.captureStackTrace(m(r),n),r.name="CompareOperatorError",r.operator=t,r}return n}(y(TypeError)),M=function(t){s(n,t);var e=d(n);function n(t){var r;return i(this,n),r=e.call(this,"Invalid data format: ".concat(t)),Error.captureStackTrace&&Error.captureStackTrace(m(r),n),r.name="ImportError",r.data=t,r}return n}(y(Error)),J=function(t){s(n,t);var e=d(n);function n(t){var r,o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return i(this,n),r=e.call(this,'Die "'.concat(t,'" must have more than 1 possible value to ').concat(o||"do this action")),Error.captureStackTrace&&Error.captureStackTrace(m(r),n),r.name="DieActionValueError",r.action=o,r.die=t,r}return n}(y(Error)),F=function(t){s(n,t);var e=d(n);function n(t){var r;return i(this,n),r=e.call(this,'Notation "'.concat(t,'" is invalid')),Error.captureStackTrace&&Error.captureStackTrace(m(r),n),r.name="NotationError",r.notation=t,r}return n}(y(Error)),_=function(t){s(n,t);var e=d(n);function n(){var t,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return i(this,n),t=e.call(this,"Missing argument".concat(r?' "'.concat(r,'"'):"")),Error.captureStackTrace&&Error.captureStackTrace(m(t),n),t.argumentName=r,t}return n}(y(Error)),I=Object.freeze({__proto__:null,CompareOperatorError:P,DataFormatError:M,DieActionValueError:J,NotationError:F,RequiredArgumentError:_}),V=function(t,e,n){var r,i=Number(t),o=Number(e);if(Number.isNaN(i)||Number.isNaN(o))return!1;switch(n){case"=":case"==":r=i===o;break;case"<":r=i<o;break;case">":r=i>o;break;case"<=":r=i<=o;break;case">=":r=i>=o;break;case"!":case"!=":case"<>":r=i!==o;break;default:r=!1;break}return r},q=function(t){return e.evaluate(t)},D=function(t){return("number"===typeof t||"string"===typeof t)&&(!Number.isNaN(t)&&Number.isFinite(Number(t)))},B=function(t){if(!D(t))return!1;var e=Number(t);return e<=Number.MAX_SAFE_INTEGER&&e>=Number.MIN_SAFE_INTEGER},G=function(t){return Array.isArray(t)?t.reduce((function(t,e){return t+(D(e)?parseFloat("".concat(e)):0)}),0):0},z=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return parseFloat(parseFloat("".concat(t)).toFixed(e||0))},U=Symbol("engine"),$=Symbol("random"),K={range:[],next:function(){return this.range[1]-this.range[0]}},L={next:function(){return 0}},X={browserCrypto:n.browserCrypto,nodeCrypto:n.nodeCrypto,MersenneTwister19937:n.MersenneTwister19937,nativeMath:n.nativeMath,min:L,max:K},H=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:n.nativeMath;i(this,t),this.engine=e||n.nativeMath}return u(t,[{key:"engine",get:function(){return this[U]},set:function(t){if(t&&"function"!==typeof t.next)throw new TypeError("engine must have function `next()`");this[U]=t||n.nativeMath,this[$]=new n.Random(this[U])}},{key:"integer",value:function(t,e){return this[U].range=[t,e],this[$].integer(t,e)}},{key:"real",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return this[U].range=[t,e],this[$].real(t,e,n)}}]),t}(),Q=new H,W=Object.freeze({__proto__:null,engines:X,generator:Q}),Y=Symbol("operator"),Z=Symbol("value"),tt=function(){function t(e,n){if(i(this,t),!e)throw new _("operator");if(!n&&0!==n)throw new _("value");this.operator=e,this.value=n}return u(t,[{key:"operator",get:function(){return this[Y]},set:function(t){if(!this.constructor.isValidOperator(t))throw new P(t);this[Y]=t}},{key:"value",get:function(){return this[Z]},set:function(t){if(!D(t))throw new TypeError("value must be a finite number");this[Z]=Number(t)}},{key:"isMatch",value:function(t){return V(t,this.value,this.operator)}},{key:"toJSON",value:function(){var t=this.operator,e=this.value;return{operator:t,type:"compare-point",value:e}}},{key:"toString",value:function(){return"".concat(this.operator).concat(this.value)}}],[{key:"isValidOperator",value:function(t){return"string"===typeof t&&/^(?:[<>!]?=|[<>]|<>)$/.test(t)}}]),t}(),et=function(){function t(){i(this,t),this.order=999}return u(t,[{key:"name",get:function(){return"modifier"}},{key:"notation",get:function(){return""}},{key:"maxIterations",get:function(){return 1e3}},{key:"run",value:function(t,e){return t}},{key:"toJSON",value:function(){var t=this.notation,e=this.name;return{name:e,notation:t,type:"modifier"}}},{key:"toString",value:function(){return this.notation}}]),t}(),nt=Symbol("compare-point"),rt=function(t){s(n,t);var e=d(n);function n(t){var r;return i(this,n),r=e.call(this),t&&(r.comparePoint=t),r}return u(n,[{key:"comparePoint",get:function(){return this[nt]},set:function(t){if(!(t instanceof tt))throw new TypeError("comparePoint must be instance of ComparePoint");this[nt]=t}},{key:"name",get:function(){return"comparison"}},{key:"notation",get:function(){return"".concat(this.comparePoint||"")}},{key:"isComparePoint",value:function(t){return!!this.comparePoint&&this.comparePoint.isMatch(t)}},{key:"toJSON",value:function(){var t=this.comparePoint;return Object.assign(b(c(n.prototype),"toJSON",this).call(this),{comparePoint:t})}}]),n}(et),it=Symbol("compound"),ot=Symbol("penetrate"),ut=function(t){s(n,t);var e=d(n);function n(){var t,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,o=arguments.length>1&&void 0!==arguments[1]&&arguments[1],u=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return i(this,n),t=e.call(this,r),t[it]=!!o,t[ot]=!!u,t.order=3,t}return u(n,[{key:"compound",get:function(){return this[it]}},{key:"name",get:function(){return"explode"}},{key:"notation",get:function(){return"!".concat(this.compound?"!":"").concat(this.penetrate?"p":"").concat(b(c(n.prototype),"notation",this))}},{key:"penetrate",get:function(){return this[ot]}},{key:"run",value:function(t,e){var n=this;if(e.min===e.max)throw new J(e,"explode");var r=t;return r.rolls=t.rolls.map((function(t){for(var r=[t],i=t.value,o=0;o<n.maxIterations&&n.isComparePoint(i);o++){var u=r[r.length-1],a=e.rollOnce();i=a.value,u.modifiers.add("explode"),n.penetrate&&(u.modifiers.add("penetrate"),a.value-=1),r.push(a)}return n.compound&&r.length>1?(t.value=G(r.map((function(t){return t.value}))),t.modifiers=["explode","compound"],n.penetrate&&t.modifiers.add("penetrate"),t):r})).flat(),r}},{key:"toJSON",value:function(){var t=this.compound,e=this.penetrate;return Object.assign(b(c(n.prototype),"toJSON",this).call(this),{compound:t,penetrate:e})}}]),n}(rt),at={compound:"!",explode:"!","critical-failure":"__","critical-success":"**",drop:"d",max:"v",min:"^",penetrate:"p","re-roll":"r","re-roll-once":"ro","target-failure":"_","target-success":"*"},st=function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return[].concat(e).reduce((function(t,e){var n;return n=e instanceof et?e.name:e,t+(at[n]||n)}),"")},ct=Symbol("calculation-value"),lt=Symbol("modifiers"),ft=Symbol("initial-value"),ht=Symbol("use-in-total"),pt=Symbol("value"),yt=function(){function t(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],o=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];if(i(this,t),D(e))this[ft]=Number(e),this.modifiers=n||[],this.useInTotal=o;else{if(!e||"object"!==r(e)||Array.isArray(e))throw e===1/0?new RangeError("Result value must be a finite number"):new TypeError("Result value is invalid: ".concat(e));var u=D(e.initialValue)?e.initialValue:e.value;if(!D(u))throw new TypeError("Result value is invalid: ".concat(u));this[ft]=Number(u),D(e.value)&&Number(e.value)!==this[ft]&&(this.value=e.value),D(e.calculationValue)&&parseFloat("".concat(e.calculationValue))!==this.value&&(this.calculationValue=e.calculationValue),this.modifiers=e.modifiers||n||[],this.useInTotal="boolean"===typeof e.useInTotal?e.useInTotal:o||!1}}return u(t,[{key:"calculationValue",get:function(){return D(this[ct])?parseFloat(this[ct]):this.value},set:function(t){var e=D(t);if(t===1/0)throw new RangeError("Result calculation value must be a finite number");if(t&&!e)throw new TypeError("Result calculation value is invalid: ".concat(t));this[ct]=e?parseFloat("".concat(t)):null}},{key:"initialValue",get:function(){return this[ft]}},{key:"modifierFlags",get:function(){return st.apply(void 0,A(this.modifiers))}},{key:"modifiers",get:function(){return this[lt]},set:function(t){if((Array.isArray(t)||t instanceof Set)&&A(t).every((function(t){return"string"===typeof t})))this[lt]=new Set(A(t));else{if(t||0===t)throw new TypeError("modifiers must be a Set or array of modifier names: ".concat(t));this[lt]=new Set}}},{key:"useInTotal",get:function(){return!!this[ht]},set:function(t){this[ht]=!!t}},{key:"value",get:function(){return D(this[pt])?this[pt]:this[ft]},set:function(t){if(t===1/0)throw new RangeError("Result value must be a finite number");if(!D(t))throw new TypeError("Result value is invalid: ".concat(t));this[pt]=Number(t)}},{key:"toJSON",value:function(){var t=this.calculationValue,e=this.initialValue,n=this.modifierFlags,r=this.modifiers,i=this.useInTotal,o=this.value;return{calculationValue:t,initialValue:e,modifierFlags:n,modifiers:A(r),type:"result",useInTotal:i,value:o}}},{key:"toString",value:function(){return this.value+this.modifierFlags}}]),t}(),mt=Symbol("rolls"),vt=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];i(this,t),this.rolls=e}return u(t,[{key:"length",get:function(){return this.rolls.length||0}},{key:"rolls",get:function(){return A(this[mt])},set:function(t){var e=this;if(!t||!Array.isArray(t))throw new TypeError("rolls must be an array: ".concat(t));this[mt]=[],t.forEach((function(t){e.addRoll(t)}))}},{key:"value",get:function(){return this.rolls.reduce((function(t,e){return t+(e.useInTotal?e.calculationValue:0)}),0)}},{key:"addRoll",value:function(t){var e=t instanceof yt?t:new yt(t);this[mt].push(e)}},{key:"toJSON",value:function(){var t=this.rolls,e=this.value;return{rolls:t,type:"roll-results",value:e}}},{key:"toString",value:function(){return"[".concat(this.rolls.join(", "),"]")}}]),t}(),dt=Symbol("once"),gt=function(t){s(n,t);var e=d(n);function n(){var t,r=arguments.length>0&&void 0!==arguments[0]&&arguments[0],o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return i(this,n),t=e.call(this,o),t.once=!!r,t.order=4,t}return u(n,[{key:"name",get:function(){return"re-roll"}},{key:"notation",get:function(){return"r".concat(this.once?"o":"").concat(b(c(n.prototype),"notation",this))}},{key:"once",get:function(){return!!this[dt]},set:function(t){this[dt]=!!t}},{key:"run",value:function(t,e){var n=this;if(e.min===e.max)throw new J(e,"re-roll");return t.rolls.map((function(t){for(var r=0;r<n.maxIterations&&n.isComparePoint(t.value);r++){var i=e.rollOnce();if(t.value=i.value,t.modifiers.add("re-roll".concat(n.once?"-once":"")),n.once)break}return t})),t}},{key:"toJSON",value:function(){var t=this.once;return Object.assign(b(c(n.prototype),"toJSON",this).call(this),{once:t})}}]),n}(rt),bt=Symbol("modifiers"),wt=Symbol("qty"),kt=Symbol("sides"),St=Symbol("min-value"),At=Symbol("max-value"),Et=function(){function t(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,u=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null;if(i(this,t),!e&&0!==e)throw new _("sides");if(e===1/0)throw new RangeError("numerical sides must be finite number");if(D(e)){if(e<1||!B(e))throw new RangeError("numerical sides must be a positive finite number")}else if("string"!==typeof e)throw new TypeError("non-numerical sides must be a string");if(!D(n))throw new TypeError("qty must be a positive finite integer");if(n<1||n>999)throw new RangeError("qty must be between 1 and 999");if(!D(o))throw new TypeError("min must a finite number");if(!B(o))throw new RangeError("min must a finite number");if(u&&!D(u))throw new TypeError("max must a finite number");if(u&&!B(u))throw new RangeError("max must a finite number");this[wt]=parseInt("".concat(n),10),this[kt]=e,r&&(this.modifiers=r),this[St]=parseInt(o,10),this[At]=u?parseInt("".concat(u),10):e}return u(t,[{key:"average",get:function(){return(this.min+this.max)/2}},{key:"modifiers",get:function(){return this[bt]?new Map(A(this[bt]).sort((function(t,e){return t[1].order-e[1].order}))):null},set:function(t){var e,n=this;if(t instanceof Map)e=t;else if(Array.isArray(t))e=new Map(t.map((function(t){return[t.name,t]})));else{if("object"!==r(t))throw new TypeError("modifiers should be a Map, array, or an Object containing Modifiers");e=new Map(Object.entries(t))}if(e.size&&A(e.entries()).some((function(t){return!(t[1]instanceof et)})))throw new TypeError("modifiers must only contain Modifier instances");this[bt]=e,this[bt].forEach((function(t){t instanceof ut&&!t.comparePoint?t.comparePoint=new tt("=",n.max):t instanceof gt&&!t.comparePoint&&(t.comparePoint=new tt("=",n.min))}))}},{key:"max",get:function(){return this[At]}},{key:"min",get:function(){return this[St]}},{key:"name",get:function(){return"standard"}},{key:"notation",get:function(){var t="".concat(this.qty,"d").concat(this.sides);return this.modifiers&&this.modifiers.size&&(t+=A(this.modifiers.values()).reduce((function(t,e){return t+e.notation}),"")),t}},{key:"qty",get:function(){return this[wt]}},{key:"sides",get:function(){return this[kt]}},{key:"roll",value:function(){for(var t=this,e=new vt,n=0;n<this.qty;n++)e.addRoll(this.rollOnce());return(this.modifiers||[]).forEach((function(n){n.run(e,t)})),e}},{key:"rollOnce",value:function(){return new yt(Q.integer(this.min,this.max))}},{key:"toJSON",value:function(){var t=this.average,e=this.max,n=this.min,r=this.modifiers,i=this.name,o=this.notation,u=this.qty,a=this.sides;return{average:t,max:e,min:n,modifiers:r,name:i,notation:o,qty:u,sides:a,type:"die"}}},{key:"toString",value:function(){return this.notation}}]),t}(),xt=function(t){s(n,t);var e=d(n);function n(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:2,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;i(this,n);var u=t;if(u||0===u){if(1!==u&&2!==u)throw new RangeError("nonBlanks must be 1 or 2")}else u=2;return e.call(this,u,r,o,-1,1)}return u(n,[{key:"name",get:function(){return"fudge"}},{key:"nonBlanks",get:function(){return b(c(n.prototype),"sides",this)}},{key:"sides",get:function(){return"F.".concat(this.nonBlanks)}},{key:"rollOnce",value:function(){var t=0;if(2===this.nonBlanks)t=Q.integer(1,3)-2;else if(1===this.nonBlanks){var e=Q.integer(1,6);1===e?t=-1:6===e&&(t=1)}return new yt(t)}}]),n}(Et),Ot=function(t){s(n,t);var e=d(n);function n(){var t,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,u=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return i(this,n),t=e.call(this,100,r,o),t.sidesAsNumber=!!u,t}return u(n,[{key:"name",get:function(){return"percentile"}},{key:"sides",get:function(){return this.sidesAsNumber?b(c(n.prototype),"sides",this):"%"}}]),n}(Et),Tt=Object.freeze({__proto__:null,FudgeDice:xt,PercentileDice:Ot,StandardDice:Et}),Ct=function(t){s(n,t);var e=d(n);function n(t){var r;return i(this,n),r=e.call(this,t),r.order=9,r}return u(n,[{key:"name",get:function(){return"critical-failure"}},{key:"notation",get:function(){return"cf".concat(b(c(n.prototype),"notation",this))}},{key:"run",value:function(t,e){var n=this;return t.rolls.forEach((function(t){return n.isComparePoint(t.value)&&t.modifiers.add("critical-failure"),t})),t}}]),n}(rt),Nt=function(t){s(n,t);var e=d(n);function n(t){var r;return i(this,n),r=e.call(this,t),r.order=8,r}return u(n,[{key:"name",get:function(){return"critical-success"}},{key:"notation",get:function(){return"cs".concat(b(c(n.prototype),"notation",this))}},{key:"run",value:function(t,e){var n=this;return t.rolls.forEach((function(t){return n.isComparePoint(t.value)&&t.modifiers.add("critical-success"),t})),t}}]),n}(rt),Rt=Symbol("calculation-value"),jt=Symbol("is-roll-group"),Pt=Symbol("modifiers"),Mt=Symbol("results"),Jt=Symbol("use-in-total"),Ft=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],o=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];i(this,t),this.isRollGroup=r,this.modifiers=n,this.results=e,this.useInTotal=o}return u(t,[{key:"calculationValue",get:function(){return D(this[Rt])?parseFloat(this[Rt]):this.value},set:function(t){var e=D(t);if(t===1/0)throw new RangeError("Results calculation value must be a finite number");if(t&&!e)throw new TypeError("Results calculation value is invalid: ".concat(t));this[Rt]=e?parseFloat("".concat(t)):null}},{key:"isRollGroup",get:function(){return this[jt]},set:function(t){this[jt]=!!t}},{key:"length",get:function(){return this.results.length||0}},{key:"modifierFlags",get:function(){return st.apply(void 0,A(this.modifiers))}},{key:"modifiers",get:function(){return this[Pt]},set:function(t){if((Array.isArray(t)||t instanceof Set)&&A(t).every((function(t){return"string"===typeof t})))this[Pt]=new Set(A(t));else{if(t||0===t)throw new TypeError("modifiers must be a Set or array of modifier names: ".concat(t));this[Pt]=new Set}}},{key:"results",get:function(){return A(this[Mt])},set:function(t){var e=this;if(!t||!Array.isArray(t))throw new TypeError("results must be an array: ".concat(t));this[Mt]=[],t.forEach((function(t){e.addResult(t)}))}},{key:"useInTotal",get:function(){return!!this[Jt]},set:function(t){this[Jt]=!!t}},{key:"value",get:function(){if(!this.results.length)return 0;var e=this.results.reduce((function(e,n){var r=n;return n instanceof t?r=n.useInTotal?n.calculationValue:0:n instanceof vt&&(r=n.value),e+r}),"string"===typeof this.results[0]?"":0);return"string"===typeof e?q(e):e}},{key:"addResult",value:function(e){var n;if(e instanceof t||e instanceof vt)n=e;else{if("string"!==typeof e&&!D(e))throw new TypeError("value must be one of ResultGroup, RollResults, string, or number");n=e}this[Mt].push(n)}},{key:"toJSON",value:function(){var t=this.calculationValue,e=this.isRollGroup,n=this.modifierFlags,r=this.modifiers,i=this.results,o=this.useInTotal,u=this.value;return{calculationValue:t,isRollGroup:e,modifierFlags:n,modifiers:A(r),results:i,type:"result-group",useInTotal:o,value:u}}},{key:"toString",value:function(){var t;return t=this.isRollGroup?"{".concat(this.results.join(", "),"}"):this.results.join(""),this.modifierFlags&&(t="(".concat(t,")").concat(this.modifierFlags)),t}}]),t}(),_t=Symbol("end"),It=Symbol("qty"),Vt=function(t){s(n,t);var e=d(n);function n(){var t,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"h",o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return i(this,n),t=e.call(this),t.end=r,t.qty=o,t.order=5,t}return u(n,[{key:"end",get:function(){return this[_t]},set:function(t){if("h"!==t&&"l"!==t)throw new RangeError('End must be "h" or "l"');this[_t]=t}},{key:"name",get:function(){return"keep-".concat(this.end)}},{key:"notation",get:function(){return"k".concat(this.end).concat(this.qty)}},{key:"qty",get:function(){return this[It]},set:function(t){if(t===1/0)throw new RangeError("qty must be a finite number");if(!D(t)||t<1)throw new TypeError("qty must be a positive finite integer");this[It]=Math.floor(t)}},{key:"rangeToDrop",value:function(t){return"h"===this.end?[0,t.length-this.qty]:[this.qty,t.length]}},{key:"run",value:function(t,e){var n,r,i;return t instanceof Ft?(r=t.results,i=1===r.length&&r[0]instanceof Ft?r[0].results.map((function(t,e){return t instanceof vt?t.rolls.map((function(t,n){return{value:t.value,index:[e,n]}})):null})).flat().filter(Boolean):A(r).map((function(t,e){return{value:t.value,index:e}}))):(r=t.rolls,i=A(r).map((function(t,e){return{value:t.value,index:e}}))),i=(n=i.sort((function(t,e){return t.value-e.value})).map((function(t){return t.index}))).slice.apply(n,A(this.rangeToDrop(i))),i.forEach((function(t){var e;e=Array.isArray(t)?r[0].results[t[0]].rolls[t[1]]:r[t],e.modifiers.add("drop"),e.useInTotal=!1})),t}},{key:"toJSON",value:function(){var t=this.end,e=this.qty;return Object.assign(b(c(n.prototype),"toJSON",this).call(this),{end:t,qty:e})}}]),n}(et),qt=function(t){s(n,t);var e=d(n);function n(){var t,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"l",o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return i(this,n),t=e.call(this,r,o),t.order=6,t}return u(n,[{key:"name",get:function(){return"drop-".concat(this.end)}},{key:"notation",get:function(){return"d".concat(this.end).concat(this.qty)}},{key:"rangeToDrop",value:function(t){return"h"===this.end?[t.length-this.qty,t.length]:[0,this.qty]}}]),n}(Vt),Dt=Symbol("max"),Bt=function(t){s(n,t);var e=d(n);function n(t){var r;return i(this,n),r=e.call(this),r.max=t,r.order=2,r}return u(n,[{key:"max",get:function(){return this[Dt]},set:function(t){if(!D(t))throw new TypeError("max must be a number");this[Dt]=parseFloat("".concat(t))}},{key:"name",get:function(){return"max"}},{key:"notation",get:function(){return"max".concat(this.max)}},{key:"run",value:function(t,e){var n=this,r=t;return r.rolls=t.rolls.map((function(t){var e=t;return t.value>n.max&&(e.value=n.max,e.modifiers.add("max")),e})),r}},{key:"toJSON",value:function(){var t=this.max;return Object.assign(b(c(n.prototype),"toJSON",this).call(this),{max:t})}}]),n}(et),Gt=Symbol("min"),zt=function(t){s(n,t);var e=d(n);function n(t){var r;return i(this,n),r=e.call(this),r.min=t,r.order=1,r}return u(n,[{key:"min",get:function(){return this[Gt]},set:function(t){if(!D(t))throw new TypeError("min must be a number");this[Gt]=parseFloat("".concat(t))}},{key:"name",get:function(){return"min"}},{key:"notation",get:function(){return"min".concat(this.min)}},{key:"run",value:function(t,e){var n=this,r=t;return r.rolls=t.rolls.map((function(t){var e=t;return t.value<n.min&&(e.value=n.min,e.modifiers.add("min")),e})),r}},{key:"toJSON",value:function(){var t=this.min;return Object.assign(b(c(n.prototype),"toJSON",this).call(this),{min:t})}}]),n}(et),Ut=Symbol("direction"),$t=function(t){s(n,t);var e=d(n);function n(){var t,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"a";return i(this,n),t=e.call(this),t.direction=r,t.order=10,t}return u(n,[{key:"direction",get:function(){return this[Ut]},set:function(t){if("a"!==t&&"d"!==t)throw new RangeError('Direction must be "a" (Ascending) or "d" (Descending)');this[Ut]=t}},{key:"name",get:function(){return"sorting"}},{key:"notation",get:function(){return"s".concat(this.direction)}},{key:"run",value:function(t,e){var n,r=this;return n=t instanceof Ft?"results":"rolls",t[n]=t[n].sort((function(t,e){return"d"===r.direction?e.value-t.value:t.value-e.value})),t instanceof Ft&&(t[n]=t[n].map((function(t){return t instanceof Ft||t instanceof vt?r.run(t,e):t}))),t}},{key:"toJSON",value:function(){var t=this.direction;return Object.assign(b(c(n.prototype),"toJSON",this).call(this),{direction:t})}}]),n}(et),Kt=Symbol("failure-cp"),Lt=function(t){s(n,t);var e=d(n);function n(t){var r,o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return i(this,n),r=e.call(this,t),r.failureComparePoint=o,r.order=7,r}return u(n,[{key:"failureComparePoint",get:function(){return this[Kt]},set:function(t){if(t&&!(t instanceof tt))throw new TypeError("failure comparePoint must be instance of ComparePoint or null");this[Kt]=t||null}},{key:"name",get:function(){return"target"}},{key:"notation",get:function(){return"".concat(b(c(n.prototype),"notation",this)).concat(this.failureComparePoint?"f".concat(this.failureComparePoint):"")}},{key:"successComparePoint",get:function(){return this.comparePoint},set:function(t){k(c(n.prototype),"comparePoint",t,this,!0)}},{key:"getStateValue",value:function(t){return this.isSuccess(t)?1:this.isFailure(t)?-1:0}},{key:"isFailure",value:function(t){return!!this.failureComparePoint&&this.failureComparePoint.isMatch(t)}},{key:"isNeutral",value:function(t){return!this.isSuccess(t)&&!this.isFailure(t)}},{key:"isSuccess",value:function(t){return this.isComparePoint(t)}},{key:"run",value:function(t,e){var n,r=this;return n=t instanceof Ft?t.results:t.rolls,n.forEach((function(t){r.isSuccess(t.value)?t.modifiers.add("target-success"):r.isFailure(t.value)&&t.modifiers.add("target-failure"),t.calculationValue=r.getStateValue(t.value)})),t}},{key:"toJSON",value:function(){var t=this.failureComparePoint,e=this.successComparePoint,r=b(c(n.prototype),"toJSON",this).call(this);return delete r.comparePoint,Object.assign(r,{failureComparePoint:t,successComparePoint:e})}}]),n}(rt),Xt=Object.freeze({__proto__:null,ComparisonModifier:rt,CriticalFailureModifier:Ct,CriticalSuccessModifier:Nt,DropModifier:qt,ExplodeModifier:ut,KeepModifier:Vt,MaxModifier:Bt,MinModifier:zt,Modifier:et,ReRollModifier:gt,SortingModifier:$t,TargetModifier:Lt}),Ht=Object.freeze({__proto__:null,ResultGroup:Ft,RollResult:yt,RollResults:vt}),Qt=function(t){try{return!(!t||btoa(atob(t))!==t)}catch(e){return!1}},Wt=function(t){try{var e=!!t&&JSON.parse(t);return!(!e||"object"!==r(e))}catch(n){return!1}},Yt=Symbol("modifiers"),Zt=Symbol("expressions"),te=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];i(this,t),this.expressions=e,this.modifiers=n}return u(t,[{key:"expressions",get:function(){return A(this[Zt]||[])},set:function(t){var e=this;if(!t)throw new _("expressions");if(!Array.isArray(t))throw new TypeError("expressions must be an array: ".concat(t));this[Zt]=[],t.forEach((function(n){if(!n||!Array.isArray(n))throw new TypeError("Expressions must be an array of arrays: ".concat(t));if(0===n.length)throw new TypeError("Sub expressions cannot be empty: ".concat(t));if(!n.every((function(t){return t instanceof Et||"string"===typeof t||"number"===typeof t})))throw new TypeError("Sub expression items must be Dice, numbers, or strings");e[Zt].push(n)}))}},{key:"modifiers",get:function(){return this[Yt]?new Map(A(this[Yt]).sort((function(t,e){return t[1].order-e[1].order}))):null},set:function(t){var e;if(t instanceof Map)e=t;else if(Array.isArray(t))e=new Map(t.map((function(t){return[t.name,t]})));else{if("object"!==r(t))throw new TypeError("modifiers should be a Map, array, or an Object containing Modifiers");e=new Map(Object.entries(t))}if(e.size&&A(e.entries()).some((function(t){return!(t[1]instanceof et)})))throw new TypeError("modifiers must only contain Modifier instances");this[Yt]=e}},{key:"notation",get:function(){var t=this.expressions.map((function(t){return t.reduce((function(t,e){return t+e}),"")})).join(", ");return t="{".concat(t,"}"),this.modifiers&&this.modifiers.size&&(t+=A(this.modifiers.values()).reduce((function(t,e){return t+e.notation}),"")),t}},{key:"roll",value:function(){var t=this,e=new Ft(this.expressions.map((function(t){var e=t.map((function(t){return t instanceof Et?t.roll():t}));return new Ft(e)})));return e.isRollGroup=!0,(this.modifiers||[]).forEach((function(n){n.run(e,t)})),e}},{key:"toJSON",value:function(){var t=this.modifiers,e=this.notation,n=this.expressions;return{expressions:n,modifiers:t,notation:e,type:"group"}}},{key:"toString",value:function(){return this.notation}}]),t}();function ee(t,e){function n(){this.constructor=t}n.prototype=e.prototype,t.prototype=new n}function ne(t,e,n,r){var i=Error.call(this,t);return Object.setPrototypeOf&&Object.setPrototypeOf(i,ne.prototype),i.expected=e,i.found=n,i.location=r,i.name="SyntaxError",i}function re(t,e,n){return n=n||" ",t.length>e?t:(e-=t.length,n+=n.repeat(e),t+n.slice(0,e))}function ie(t,e){e=void 0!==e?e:{};var n,r={},i=e.grammarSource,o={Main:pn},u=pn,s="{",c=",",l="}",f="d",h="d%",p="dF",y=".",m="!",v="p",d="k",g="max",b="min",w="r",k="o",E="cs",x="cf",O="s",T="a",C="f",N="!=",R="<=",j=">=",P="=",M="<>",J=">",F="<",_="(",I=")",V="abs",D="ceil",B="cos",G="exp",z="floor",U="log",$="round",K="sign",L="sin",X="sqrt",H="tan",Q="pow",W="-",Y="**",Z="*",et="^",nt="%",rt="/",it="+",ot=/^[12]/,at=/^[lh]/,st=/^[.]/,ct=/^[1-9]/,lt=/^[0-9]/,ft=/^[ \t\n\r]/,ht=on("{",!1),pt=on(",",!1),yt=on("}",!1),mt=on("d",!1),vt=on("d%",!1),dt=on("dF",!1),bt=on(".",!1),wt=un(["1","2"],!1,!1),kt=on("!",!1),St=on("p",!1),At=un(["l","h"],!1,!1),Tt=on("k",!1),Rt=on("max",!1),jt=on("min",!1),Pt=on("r",!1),Mt=on("o",!1),Jt=on("cs",!1),Ft=on("cf",!1),_t=on("s",!1),It=on("a",!1),Dt=on("f",!1),Gt=on("!=",!1),Ut=on("<=",!1),Kt=on(">=",!1),Xt=on("=",!1),Ht=on("<>",!1),Qt=on(">",!1),Wt=on("<",!1),Yt=on("(",!1),Zt=on(")",!1),ee=on("abs",!1),re=on("ceil",!1),ie=on("cos",!1),oe=on("exp",!1),ue=on("floor",!1),ae=on("log",!1),se=on("round",!1),ce=on("sign",!1),le=on("sin",!1),fe=on("sqrt",!1),he=on("tan",!1),pe=on("pow",!1),ye=on("-",!1),me=un(["."],!1,!1),ve=un([["1","9"]],!1,!1),de=un([["0","9"]],!1,!1),ge=on("**",!1),be=on("*",!1),we=on("^",!1),ke=on("%",!1),Se=on("/",!1),Ae=on("+",!1),Ee=sn("whitespace"),xe=un([" ","\t","\n","\r"],!1,!1),Oe=function(t,e,n){return new te([t].concat(A(e.map((function(t){return t[3]})))),Object.assign.apply(Object,[{}].concat(A(n.map((function(t){return a({},t.name,t)}))))))},Te=function(t,e){return t.modifiers=Object.assign.apply(Object,[{}].concat(A(e.map((function(t){return a({},t.name,t)}))))),t},Ce=function(t,e){return new Et(e,t||1)},Ne=function(t){return new Ot(t||1)},Re=function(t,e){return new xt(e?parseInt(e[1],10):2,t||1)},je=function(t,e,n){return new ut(n,!!t,!!e)},Pe=function(t,e){return new Lt(t,e)},Me=function(t,e){return new qt(t||"l",e)},Je=function(t,e){return new Vt(t||"h",e)},Fe=function(t){return new Bt(t)},_e=function(t){return new zt(t)},Ie=function(t,e){return new gt(!!t,e)},Ve=function(t){return new Nt(t)},qe=function(t){return new Ct(t)},De=function(t){return new $t(t||"a")},Be=function(t){return t},Ge=function(t,e){return new tt(t,e)},ze=function(t,e,n){return q(rn())},Ue=function(t,e){return t=Array.isArray(t)?t:[t],[].concat(A(t),A(e.map((function(t){var e=S(t,4),n=e[1],r=e[3];return[n,r]})).flat(2)))},$e=function(t,e,n){return[t].concat(A(e),[n])},Ke=function(t,e){return["".concat(t,"(")].concat(A(e),[")"])},Le=function(t,e,n){return["".concat(t,"(")].concat(A(e),[","],A(n),[")"])},Xe=function(){return parseFloat(rn())},He=function(){return parseInt(rn(),10)},Qe=function(){return"^"},We=0,Ye=0,Ze=[{line:1,column:1}],tn=0,en=[],nn=0;if("startRule"in e){if(!(e.startRule in o))throw new Error("Can't start parsing from rule \""+e.startRule+'".');u=o[e.startRule]}function rn(){return t.substring(Ye,We)}function on(t,e){return{type:"literal",text:t,ignoreCase:e}}function un(t,e,n){return{type:"class",parts:t,inverted:e,ignoreCase:n}}function an(){return{type:"end"}}function sn(t){return{type:"other",description:t}}function cn(e){var n,r=Ze[e];if(r)return r;n=e-1;while(!Ze[n])n--;r=Ze[n],r={line:r.line,column:r.column};while(n<e)10===t.charCodeAt(n)?(r.line++,r.column=1):r.column++,n++;return Ze[e]=r,r}function ln(t,e){var n=cn(t),r=cn(e);return{source:i,start:{offset:t,line:n.line,column:n.column},end:{offset:e,line:r.line,column:r.column}}}function fn(t){We<tn||(We>tn&&(tn=We,en=[]),en.push(t))}function hn(t,e,n){return new ne(ne.buildMessage(t,e),t,e,n)}function pn(){var t;return t=Jn(),t}function yn(){var e,n,i,o,u,a,f,h,p;if(e=We,123===t.charCodeAt(We)?(n=s,We++):(n=r,0===nn&&fn(ht)),n!==r)if(Bn(),i=Jn(),i!==r){o=[],u=We,a=Bn(),44===t.charCodeAt(We)?(f=c,We++):(f=r,0===nn&&fn(pt)),f!==r?(h=Bn(),p=Jn(),p!==r?(a=[a,f,h,p],u=a):(We=u,u=r)):(We=u,u=r);while(u!==r)o.push(u),u=We,a=Bn(),44===t.charCodeAt(We)?(f=c,We++):(f=r,0===nn&&fn(pt)),f!==r?(h=Bn(),p=Jn(),p!==r?(a=[a,f,h,p],u=a):(We=u,u=r)):(We=u,u=r);if(u=Bn(),125===t.charCodeAt(We)?(a=l,We++):(a=r,0===nn&&fn(yt)),a!==r){f=[],h=bn();while(h!==r)f.push(h),h=bn();Ye=e,e=Oe(i,o,f)}else We=e,e=r}else We=e,e=r;else We=e,e=r;return e}function mn(){var t,e,n,i;if(t=We,e=vn(),e===r&&(e=dn(),e===r&&(e=gn())),e!==r){n=[],i=bn();while(i!==r)n.push(i),i=bn();Ye=t,t=Te(e,n)}else We=t,t=r;return t}function vn(){var e,n,i,o;return e=We,n=Mn(),n===r&&(n=null),100===t.charCodeAt(We)?(i=f,We++):(i=r,0===nn&&fn(mt)),i!==r?(o=Mn(),o!==r?(Ye=e,e=Ce(n,o)):(We=e,e=r)):(We=e,e=r),e}function dn(){var e,n,i;return e=We,n=Mn(),n===r&&(n=null),t.substr(We,2)===h?(i=h,We+=2):(i=r,0===nn&&fn(vt)),i!==r?(Ye=e,e=Ne(n)):(We=e,e=r),e}function gn(){var e,n,i,o,u,a;return e=We,n=Mn(),n===r&&(n=null),t.substr(We,2)===p?(i=p,We+=2):(i=r,0===nn&&fn(dt)),i!==r?(o=We,46===t.charCodeAt(We)?(u=y,We++):(u=r,0===nn&&fn(bt)),u!==r?(ot.test(t.charAt(We))?(a=t.charAt(We),We++):(a=r,0===nn&&fn(wt)),a!==r?(u=[u,a],o=u):(We=o,o=r)):(We=o,o=r),o===r&&(o=null),Ye=e,e=Re(n,o)):(We=e,e=r),e}function bn(){var t;return t=wn(),t===r&&(t=kn(),t===r&&(t=Sn(),t===r&&(t=An(),t===r&&(t=On(),t===r&&(t=Tn(),t===r&&(t=Cn(),t===r&&(t=Nn(),t===r&&(t=En(),t===r&&(t=xn()))))))))),t}function wn(){var e,n,i,o,u;return e=We,33===t.charCodeAt(We)?(n=m,We++):(n=r,0===nn&&fn(kt)),n!==r?(33===t.charCodeAt(We)?(i=m,We++):(i=r,0===nn&&fn(kt)),i===r&&(i=null),112===t.charCodeAt(We)?(o=v,We++):(o=r,0===nn&&fn(St)),o===r&&(o=null),u=jn(),u===r&&(u=null),Ye=e,e=je(i,o,u)):(We=e,e=r),e}function kn(){var t,e,n;return t=We,e=jn(),e!==r?(n=Rn(),n===r&&(n=null),Ye=t,t=Pe(e,n)):(We=t,t=r),t}function Sn(){var e,n,i,o;return e=We,100===t.charCodeAt(We)?(n=f,We++):(n=r,0===nn&&fn(mt)),n!==r?(at.test(t.charAt(We))?(i=t.charAt(We),We++):(i=r,0===nn&&fn(At)),i===r&&(i=null),o=Vn(),o!==r?(Ye=e,e=Me(i,o)):(We=e,e=r)):(We=e,e=r),e}function An(){var e,n,i,o;return e=We,107===t.charCodeAt(We)?(n=d,We++):(n=r,0===nn&&fn(Tt)),n!==r?(at.test(t.charAt(We))?(i=t.charAt(We),We++):(i=r,0===nn&&fn(At)),i===r&&(i=null),o=Vn(),o!==r?(Ye=e,e=Je(i,o)):(We=e,e=r)):(We=e,e=r),e}function En(){var e,n,i;return e=We,t.substr(We,3)===g?(n=g,We+=3):(n=r,0===nn&&fn(Rt)),n!==r?(i=In(),i!==r?(Ye=e,e=Fe(i)):(We=e,e=r)):(We=e,e=r),e}function xn(){var e,n,i;return e=We,t.substr(We,3)===b?(n=b,We+=3):(n=r,0===nn&&fn(jt)),n!==r?(i=In(),i!==r?(Ye=e,e=_e(i)):(We=e,e=r)):(We=e,e=r),e}function On(){var e,n,i,o;return e=We,114===t.charCodeAt(We)?(n=w,We++):(n=r,0===nn&&fn(Pt)),n!==r?(111===t.charCodeAt(We)?(i=k,We++):(i=r,0===nn&&fn(Mt)),i===r&&(i=null),o=jn(),o===r&&(o=null),Ye=e,e=Ie(i,o)):(We=e,e=r),e}function Tn(){var e,n,i;return e=We,t.substr(We,2)===E?(n=E,We+=2):(n=r,0===nn&&fn(Jt)),n!==r?(i=jn(),i!==r?(Ye=e,e=Ve(i)):(We=e,e=r)):(We=e,e=r),e}function Cn(){var e,n,i;return e=We,t.substr(We,2)===x?(n=x,We+=2):(n=r,0===nn&&fn(Ft)),n!==r?(i=jn(),i!==r?(Ye=e,e=qe(i)):(We=e,e=r)):(We=e,e=r),e}function Nn(){var e,n,i;return e=We,115===t.charCodeAt(We)?(n=O,We++):(n=r,0===nn&&fn(_t)),n!==r?(97===t.charCodeAt(We)?(i=T,We++):(i=r,0===nn&&fn(It)),i===r&&(100===t.charCodeAt(We)?(i=f,We++):(i=r,0===nn&&fn(mt))),i===r&&(i=null),Ye=e,e=De(i)):(We=e,e=r),e}function Rn(){var e,n,i;return e=We,102===t.charCodeAt(We)?(n=C,We++):(n=r,0===nn&&fn(Dt)),n!==r?(i=jn(),i!==r?(Ye=e,e=Be(i)):(We=e,e=r)):(We=e,e=r),e}function jn(){var t,e,n;return t=We,e=Pn(),e!==r?(n=In(),n!==r?(Ye=t,t=Ge(e,n)):(We=t,t=r)):(We=t,t=r),t}function Pn(){var e;return t.substr(We,2)===N?(e=N,We+=2):(e=r,0===nn&&fn(Gt)),e===r&&(t.substr(We,2)===R?(e=R,We+=2):(e=r,0===nn&&fn(Ut)),e===r&&(t.substr(We,2)===j?(e=j,We+=2):(e=r,0===nn&&fn(Kt)),e===r&&(61===t.charCodeAt(We)?(e=P,We++):(e=r,0===nn&&fn(Xt)),e===r&&(t.substr(We,2)===M?(e=M,We+=2):(e=r,0===nn&&fn(Ht)),e===r&&(62===t.charCodeAt(We)?(e=J,We++):(e=r,0===nn&&fn(Qt)),e===r&&(60===t.charCodeAt(We)?(e=F,We++):(e=r,0===nn&&fn(Wt)))))))),e}function Mn(){var e,n,i,o,u,a,s,c,l,f;if(e=Vn(),e===r)if(e=We,40===t.charCodeAt(We)?(n=_,We++):(n=r,0===nn&&fn(Yt)),n!==r){if(Bn(),i=We,o=In(),o!==r){if(u=[],a=We,s=Bn(),c=Dn(),c!==r?(l=Bn(),f=In(),f!==r?(s=[s,c,l,f],a=s):(We=a,a=r)):(We=a,a=r),a!==r)while(a!==r)u.push(a),a=We,s=Bn(),c=Dn(),c!==r?(l=Bn(),f=In(),f!==r?(s=[s,c,l,f],a=s):(We=a,a=r)):(We=a,a=r);else u=r;u!==r?(o=[o,u],i=o):(We=i,i=r)}else We=i,i=r;i!==r?(o=Bn(),41===t.charCodeAt(We)?(u=I,We++):(u=r,0===nn&&fn(Zt)),u!==r?(Ye=e,e=ze()):(We=e,e=r)):(We=e,e=r)}else We=e,e=r;return e}function Jn(){var t,e,n,i,o,u,a,s;if(t=We,e=Fn(),e!==r){n=[],i=We,o=Bn(),u=Dn(),u!==r?(a=Bn(),s=Fn(),s!==r?(o=[o,u,a,s],i=o):(We=i,i=r)):(We=i,i=r);while(i!==r)n.push(i),i=We,o=Bn(),u=Dn(),u!==r?(a=Bn(),s=Fn(),s!==r?(o=[o,u,a,s],i=o):(We=i,i=r)):(We=i,i=r);Ye=t,t=Ue(e,n)}else We=t,t=r;return t}function Fn(){var e,n,i,o;return e=_n(),e===r&&(e=mn(),e===r&&(e=In(),e===r&&(e=We,40===t.charCodeAt(We)?(n=_,We++):(n=r,0===nn&&fn(Yt)),n!==r?(Bn(),i=Jn(),i!==r?(Bn(),41===t.charCodeAt(We)?(o=I,We++):(o=r,0===nn&&fn(Zt)),o!==r?(Ye=e,e=$e(n,i,o)):(We=e,e=r)):(We=e,e=r)):(We=e,e=r),e===r&&(e=yn())))),e}function _n(){var e,n,i,o,u,a,s;return e=We,t.substr(We,3)===V?(n=V,We+=3):(n=r,0===nn&&fn(ee)),n===r&&(t.substr(We,4)===D?(n=D,We+=4):(n=r,0===nn&&fn(re)),n===r&&(t.substr(We,3)===B?(n=B,We+=3):(n=r,0===nn&&fn(ie)),n===r&&(t.substr(We,3)===G?(n=G,We+=3):(n=r,0===nn&&fn(oe)),n===r&&(t.substr(We,5)===z?(n=z,We+=5):(n=r,0===nn&&fn(ue)),n===r&&(t.substr(We,3)===U?(n=U,We+=3):(n=r,0===nn&&fn(ae)),n===r&&(t.substr(We,5)===$?(n=$,We+=5):(n=r,0===nn&&fn(se)),n===r&&(t.substr(We,4)===K?(n=K,We+=4):(n=r,0===nn&&fn(ce)),n===r&&(t.substr(We,3)===L?(n=L,We+=3):(n=r,0===nn&&fn(le)),n===r&&(t.substr(We,4)===X?(n=X,We+=4):(n=r,0===nn&&fn(fe)),n===r&&(t.substr(We,3)===H?(n=H,We+=3):(n=r,0===nn&&fn(he)))))))))))),n!==r?(40===t.charCodeAt(We)?(i=_,We++):(i=r,0===nn&&fn(Yt)),i!==r?(Bn(),o=Jn(),o!==r?(Bn(),41===t.charCodeAt(We)?(u=I,We++):(u=r,0===nn&&fn(Zt)),u!==r?(Ye=e,e=Ke(n,o)):(We=e,e=r)):(We=e,e=r)):(We=e,e=r)):(We=e,e=r),e===r&&(e=We,t.substr(We,3)===Q?(n=Q,We+=3):(n=r,0===nn&&fn(pe)),n===r&&(t.substr(We,3)===g?(n=g,We+=3):(n=r,0===nn&&fn(Rt)),n===r&&(t.substr(We,3)===b?(n=b,We+=3):(n=r,0===nn&&fn(jt)))),n!==r?(40===t.charCodeAt(We)?(i=_,We++):(i=r,0===nn&&fn(Yt)),i!==r?(Bn(),o=Jn(),o!==r?(Bn(),44===t.charCodeAt(We)?(u=c,We++):(u=r,0===nn&&fn(pt)),u!==r?(Bn(),a=Jn(),a!==r?(Bn(),41===t.charCodeAt(We)?(s=I,We++):(s=r,0===nn&&fn(Zt)),s!==r?(Ye=e,e=Le(n,o,a)):(We=e,e=r)):(We=e,e=r)):(We=e,e=r)):(We=e,e=r)):(We=e,e=r)):(We=e,e=r)),e}function In(){var e,n,i,o,u;return e=We,45===t.charCodeAt(We)?We++:0===nn&&fn(ye),n=qn(),n!==r?(i=We,st.test(t.charAt(We))?(o=t.charAt(We),We++):(o=r,0===nn&&fn(me)),o!==r?(u=qn(),u!==r?(o=[o,u],i=o):(We=i,i=r)):(We=i,i=r),i===r&&(i=null),Ye=e,e=Xe()):(We=e,e=r),e}function Vn(){var e,n,i,o;if(e=We,ct.test(t.charAt(We))?(n=t.charAt(We),We++):(n=r,0===nn&&fn(ve)),n!==r){i=[],lt.test(t.charAt(We))?(o=t.charAt(We),We++):(o=r,0===nn&&fn(de));while(o!==r)i.push(o),lt.test(t.charAt(We))?(o=t.charAt(We),We++):(o=r,0===nn&&fn(de));Ye=e,e=He()}else We=e,e=r;return e}function qn(){var e,n,i;if(e=We,n=[],lt.test(t.charAt(We))?(i=t.charAt(We),We++):(i=r,0===nn&&fn(de)),i!==r)while(i!==r)n.push(i),lt.test(t.charAt(We))?(i=t.charAt(We),We++):(i=r,0===nn&&fn(de));else n=r;return n!==r&&(Ye=e,n=He()),e=n,e}function Dn(){var e,n;return e=We,t.substr(We,2)===Y?(n=Y,We+=2):(n=r,0===nn&&fn(ge)),n!==r&&(Ye=e,n=Qe()),e=n,e===r&&(42===t.charCodeAt(We)?(e=Z,We++):(e=r,0===nn&&fn(be)),e===r&&(94===t.charCodeAt(We)?(e=et,We++):(e=r,0===nn&&fn(we)),e===r&&(37===t.charCodeAt(We)?(e=nt,We++):(e=r,0===nn&&fn(ke)),e===r&&(47===t.charCodeAt(We)?(e=rt,We++):(e=r,0===nn&&fn(Se)),e===r&&(43===t.charCodeAt(We)?(e=it,We++):(e=r,0===nn&&fn(Ae)),e===r&&(45===t.charCodeAt(We)?(e=W,We++):(e=r,0===nn&&fn(ye)))))))),e}function Bn(){var e,n;nn++,e=[],ft.test(t.charAt(We))?(n=t.charAt(We),We++):(n=r,0===nn&&fn(xe));while(n!==r)e.push(n),ft.test(t.charAt(We))?(n=t.charAt(We),We++):(n=r,0===nn&&fn(xe));return nn--,n=r,0===nn&&fn(Ee),e}if(n=u(),n!==r&&We===t.length)return n;throw n!==r&&We<t.length&&fn(an()),hn(en,tn<t.length?t.charAt(tn):null,tn<t.length?ln(tn,tn+1):ln(tn,tn))}ee(ne,Error),ne.prototype.format=function(t){var e="Error: "+this.message;if(this.location){var n,r=null;for(n=0;n<t.length;n++)if(t[n].source===this.location.source){r=t[n].text.split(/\r\n|\n|\r/g);break}var i=this.location.start,o=this.location.source+":"+i.line+":"+i.column;if(r){var u=this.location.end,a=re("",i.line.toString().length),s=r[i.line-1],c=i.line===u.line?u.column:s.length+1;e+="\n --\x3e "+o+"\n"+a+" |\n"+i.line+" | "+s+"\n"+a+" | "+re("",i.column-1)+re("",c-i.column,"^")}else e+="\n at "+o}return e},ne.buildMessage=function(t,e){var n={literal:function(t){return'"'+i(t.text)+'"'},class:function(t){var e=t.parts.map((function(t){return Array.isArray(t)?o(t[0])+"-"+o(t[1]):o(t)}));return"["+(t.inverted?"^":"")+e+"]"},any:function(){return"any character"},end:function(){return"end of input"},other:function(t){return t.description}};function r(t){return t.charCodeAt(0).toString(16).toUpperCase()}function i(t){return t.replace(/\\/g,"\\\\").replace(/"/g,'\\"').replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,(function(t){return"\\x0"+r(t)})).replace(/[\x10-\x1F\x7F-\x9F]/g,(function(t){return"\\x"+r(t)}))}function o(t){return t.replace(/\\/g,"\\\\").replace(/\]/g,"\\]").replace(/\^/g,"\\^").replace(/-/g,"\\-").replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,(function(t){return"\\x0"+r(t)})).replace(/[\x10-\x1F\x7F-\x9F]/g,(function(t){return"\\x"+r(t)}))}function u(t){return n[t.type](t)}function a(t){var e,n,r=t.map(u);if(r.sort(),r.length>0){for(e=1,n=1;e<r.length;e++)r[e-1]!==r[e]&&(r[n]=r[e],n++);r.length=n}switch(r.length){case 1:return r[0];case 2:return r[0]+" or "+r[1];default:return r.slice(0,-1).join(", ")+", or "+r[r.length-1]}}function s(t){return t?'"'+i(t)+'"':"end of input"}return"Expected "+a(t)+" but "+s(e)+" found."};var oe=function(){function t(){i(this,t)}return u(t,null,[{key:"parse",value:function(t){if(!t)throw new _("notation");if("string"!==typeof t)throw new TypeError("Notation must be a string");return ie(t)}}]),t}(),ue=Object.freeze({BASE_64:1,JSON:0,OBJECT:2}),ae=Symbol("notation"),se=Symbol("maxTotal"),ce=Symbol("minTotal"),le=Symbol("expressions"),fe=Symbol("roll-method"),he=Symbol("rolls"),pe=Symbol("set-rolls"),ye=Symbol("total"),me=function(t){return z(t.calculationValue,2)},ve=function(){function t(e){if(i(this,t),!e)throw new _("notation");if(this[le]=[],e instanceof Object&&!Array.isArray(e)){if(!e.notation)throw new _("notation");if("string"!==typeof e.notation)throw new F(e.notation);e.rolls&&this[pe](e.rolls),this[ae]=e.notation,this[le]=oe.parse(this.notation),this.hasRolls()||this.roll()}else{if("string"!==typeof e)throw new F(e);this[ae]=e,this[le]=oe.parse(this.notation),this.roll()}}return u(t,[{key:"averageTotal",get:function(){return(this.maxTotal+this.minTotal)/2}},{key:"maxTotal",get:function(){if(!this.hasExpressions())return 0;if(!this[se]){var t=this[fe](X.max);this[se]=me(t)}return this[se]}},{key:"minTotal",get:function(){if(!this.hasExpressions())return 0;if(!this[ce]){var t=this[fe](X.min);this[ce]=me(t)}return this[ce]}},{key:"notation",get:function(){return this[ae]}},{key:"output",get:function(){var t="".concat(this.notation,": ");return this.hasRolls()?t+="".concat(this[he]," = ").concat(this.total):t+="No dice rolled",t}},{key:"rolls",get:function(){return this[he]?this[he].results:[]}},{key:"total",get:function(){return!this[ye]&&this.hasRolls()&&(this[ye]=me(this[he])),this[ye]||0}},{key:"export",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ue.JSON;switch(t){case ue.BASE_64:return btoa(this.export(ue.JSON));case ue.JSON:return JSON.stringify(this);case ue.OBJECT:return JSON.parse(this.export(ue.JSON));default:throw new TypeError('Invalid export format "'.concat(t,'"'))}}},{key:"hasExpressions",value:function(){return this[le]&&this[le].length>0}},{key:"hasRolls",value:function(){return this.hasExpressions()&&this.rolls.length>0}},{key:"roll",value:function(){return this[ye]=0,this[he]=this[fe](),this.rolls}},{key:"toJSON",value:function(){var t=this.averageTotal,e=this.maxTotal,n=this.minTotal,r=this.notation,i=this.output,o=this.rolls,u=this.total;return{averageTotal:t,maxTotal:e,minTotal:n,notation:r,output:i,rolls:o,total:u,type:"dice-roll"}}},{key:"toString",value:function(){return this.output}},{key:fe,value:function(t){var e;t&&(e=Q.engine,Q.engine=t);var n=new Ft(this[le].map((function(t){return t instanceof Et||t instanceof te?t.roll():t})).filter((function(t){return!!t||0===t})));return t&&(Q.engine=e),n}},{key:pe,value:function(t){if(t instanceof Ft)this[he]=t;else if(t instanceof vt)this[he]=new Ft([t]);else{if(!Array.isArray(t))throw new TypeError("Rolls must be a valid result object, or an array");this[he]=new Ft(t.map((function(t){if(t instanceof Ft||t instanceof vt)return t;if(Array.isArray(t))return new vt(t);if("object"===r(t)){if(Array.isArray(t.results))return new Ft(t.results,t.modifiers||[],t.isRollGroup||!1,"boolean"!==typeof t.useInTotal||t.useInTotal);if(Array.isArray(t.rolls))return new vt(t.rolls)}return t})))}}}],[{key:"import",value:function(e){if(e){if(Wt(e))return t.import(JSON.parse(e));if(Qt(e))return t.import(atob(e));if("object"===r(e))return new t(e);throw new M(e)}throw new _("data")}}]),t}(),de=Symbol("log"),ge=function(){function t(e){i(this,t),this[de]=[],e&&this.import(e)}return u(t,[{key:"log",get:function(){return this[de]||[]}},{key:"output",get:function(){return this.log.join("; ")}},{key:"total",get:function(){return this.log.reduce((function(t,e){return t+e.total}),0)}},{key:"clearLog",value:function(){this[de].length=0}},{key:"export",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ue.JSON;switch(t){case ue.BASE_64:return btoa(this.export(ue.JSON));case ue.JSON:return JSON.stringify(this);case ue.OBJECT:return JSON.parse(this.export(ue.JSON));default:throw new TypeError('Invalid export format "'.concat(t,'"'))}}},{key:"import",value:function(t){var e=this;if(t){if(Wt(t))return this.import(JSON.parse(t));if(Qt(t))return this.import(atob(t));if("object"===r(t)){var n=t.log||null;if(!t.log&&Array.isArray(t)&&t.length&&(n=t),n&&Array.isArray(n))n.forEach((function(t){e[de].push(ve.import(t))}));else if(n)throw new TypeError("log must be an array");return this.log}throw new M(t)}throw new _("data")}},{key:"roll",value:function(){for(var t=this,e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];var i=n.filter(Boolean);if(0===i.length)throw new _("notations");var o=i.map((function(e){var n=new ve(e);return t[de].push(n),n}));return o.length>1?o:o[0]}},{key:"toJSON",value:function(){var t=this.log,e=this.output,n=this.total;return{log:t,output:e,total:n,type:"dice-roller"}}},{key:"toString",value:function(){return this.output}}],[{key:"import",value:function(e){var n=new t;return n.import(e),n}}]),t}();t.ComparePoint=tt,t.Dice=Tt,t.DiceRoll=ve,t.DiceRoller=ge,t.Exceptions=I,t.Modifiers=Xt,t.NumberGenerator=W,t.Parser=oe,t.Results=Ht,t.RollGroup=te,t.exportFormats=ue,Object.defineProperty(t,"__esModule",{value:!0})}))}}]);